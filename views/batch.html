{% extends "navbar.html" %}

{% block content %}
    <div class="row">
        {% if result %}
            <div class="col-sm-12 col-sm-offset-1 alert alert-success">
                Batch upload successful!
            </div>
        {% endif %}
    </div>
    <div class="row">
        <form action="" method="post" enctype='multipart/form-data' id='productForm'>
            <div class="col-lg-10 col-lg-offset-1 col-sm-12">
                {% if shops is empty %}
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        Create New Product
                    </div>
                    <div class="panel-body">
                        <div class="alert alert-warning">
                            You need access to a shop before you can create products
                        </div>
                    </div>
                </div>
                {% else %}
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        Batch Product Upload
                    </div>
                    <div class="panel-body">
                        <div class='form-group col-sm-12'>
                            <label class='control-label'>ZIP File</label>
                            <input type="file" name="zip_file" value="">
                        </div>
                        <div class="form-group col-lg-6 col-sm-12">
                            <label class='control-label'>Shop</label>
                            <select class='form-control' name='shop'>
                                {% for shop in shops %}
                                    {% if shop.id in user.default_shops %}
                                        <option value="{{ shop.id}}" selected>{{shop.myshopify_domain}}</option>
                                    {% else %}
                                        <option value="{{ shop.id }}">{{ shop.myshopify_domain }}</option>
                                    {% endif %}
                                {% endfor %}
                            </select>
                        </div>

                        <div class='form-group col-lg-6 col-sm-12'>
                            <label class='control-label'>Product Title</label>
                            <input type="text" name="product_title" value="" class='form-control' required>
                        </div>
                        <div class='form-group col-lg-6 col-sm-12'>
                            <label class='control-label'>Vendor</label>
                            <input type="text" name="vendor" value="" class='form-control'>
                        </div>
                        <div class="form-group col-lg-6 col-sm-12">
                            <label class='control-label'>SKU</label>
                            <input type="text" name="sku" value="" class='form-control'>
                        </div>
                        <div class="form-group col-sm-12">
                            <label class='control-label'>Tags</label>
                            <input type='text' name="tags" placeholder='We can default this to whatever you want as well' class='form-control'>
                        </div>
                        <div class="form-group col-sm-12">
                            <label class='control-label'>Template</label>
                            <select class="form-control" name="template">
                                {% for template in templates %}
                                    <option value="{{ template.handle }}">{{ template.name }}</option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="form-group col-sm-6">
                            <label class='control-label'>Showcase Color</label>
                            <select name='default_color' class='form-control'>
                                <option value='Navy' selected>Navy</option>
                                <option value='Black'>Black</option>
                                <option value='Charcoal'>Charcoal</option>
                                <option value='Royal'>Royal Blue</option>
                            </select>
                        </div>
                        <div class="form-group col-sm-6">
                            <label class='control-label'>Showcase Product</label>
                            <select class='form-control' name="default_product">
                                <option value="Hoodie">Hoodie</option>
                                <option value="Tank">Tank</option>
                                <option value="Tee">Tee</option>
                                <option value="Long Sleeve" selected>Long Sleeve</option>
                            </select>
                        </div>

                        <!-- <div class="form-group col-sm-12">
                            <div class="checkbox">
                                <label>
                                    <input type='checkbox' id='log_to_google' name="log_to_google" value="1" onchange='setGoogleFieldsVisibility()' checked>Log to Google
                                </label>
                            </div>
                        </div>
                        <div id="google-fields">
                            <div class="form-group col-sm-12">
                                <label class='control-label'>Print Type</label>
                                <select class="form-control" name="print_type" onchange='setPrintType()'>
                                    <option value="front_print" selected>Front Print</option>
                                    <option value="back_print">Back Print</option>
                                    <option value="double_sided">Front &amp; Back</option>
                                </select>
                            </div>
                            <div class="form-group col-sm-6" id='front_print_url_field'>
                                <label class='control-label'>Front Print URL</label>
                                <input type="text" class='form-control' name="front_print_url" value="">
                            </div>
                            <div class="form-group col-sm-6" id='back_print_url_field' style='display:none'>
                                <label class='control-label'>Back Print URL</label>
                                <input type="text" class='form-control' name="back_print_url" value="">
                            </div>
                        </div> -->
                    </div>
                    <div class="panel-footer">
                        <input type="submit" name="name" value="Upload Batch Product" class='btn btn-sm btn-primary pull-right' id='submit'>
                        <div class='clearfix'></div>
                    </div>
                </div>
                {% endif %}
            </div>
        </form>
    </div>

{% endblock %}

{% block scripts %}
<script type="text/javascript">
    $(document).ready(function() {
        $('#advanced').click(function(ev) {
            $('#advanced-wrapper').toggle();
        })
        $('input[type="checkbox"]').click(function() {
            if ($('input[type="checkbox"]:checked').length > 0) {
                $('#submit').prop('disabled', false);
            } else {
                $('#submit').prop('disabled', true);
            }
        })
        function selectAllStores() {
            $('input[type="checkbox"]').each(function() {
                if (!$(this).prop('checked')) {
                    $(this).prop('checked', true);
                }
            })
        }
        function deselectAllStores() {
            $('input[type="checkbox"]').each(function() {
                if ($(this).prop('checked')) {
                    $(this).prop('checked', false);
                }
            })
        }
        function setPrintType() {
            var printType = $('select[name="print_type"] :selected').val();
            switch (printType) {
                case 'front_print':
                    $('#front_print_url_field').show();
                    $('#back_print_url_field').hide();
                    break;
                case 'back_print':
                    $('#front_print_url_field').hide();
                    $('#back_print_url_field').show();
                    break;
                case 'double_sided':
                    $('#front_print_url_field').show();
                    $('#back_print_url_field').show();
                    break;

            }
        }
        function showSubTemplates(selectorId)
        {
            var subSelector = $(selectorId);
            $('#sub_template_selector .select_container').each(function(index) {
                $(this).hide();
            })
            subSelector.show();
        }

        $('select[name="template"]').on('change', function() {
            var option = $('select[name="template"] :selected').val();
            var subSelectorId = `#${option}_product_type`;
            showSubTemplates(subSelectorId)
        })

        function setGoogleFieldsVisibility() {
            if ($('input[name="log_to_google"]:checked').length > 0) {
                $('#google-fields').show();
            } else {
                $('#google-fields').hide();
            }
        }

        // Initialize our form
        var option = $('select[name="template"] :selected').val();
        var subSelectorId = `#${option}_product_type`;
        showSubTemplates(subSelectorId)
    })
</script>
{% endblock %}
